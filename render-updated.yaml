# Render Blueprint Configuration for Brain AI Pro Trader
# Complete deployment configuration with all services
# DEPLOY FROM: master branch
# FIXED: Removed hardcoded secrets, fixed Dockerfile paths

services:
  # ========================================
  # FRONTEND SERVICE
  # ========================================
  - type: web
    name: ai-trading-frontend
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    branch: master
    plan: starter
    healthCheckPath: /api/health
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_TELEMETRY_DISABLED
        value: 1
      - key: DATABASE_URL
        sync: false  # Must be set manually in Render dashboard
      - key: NEXTAUTH_SECRET
        generateValue: true  # Auto-generate secure secret
      - key: NEXTAUTH_URL
        fromService:
          type: web
          name: ai-trading-frontend
          envVarKey: RENDER_EXTERNAL_URL
      - key: PYTHON_PATTERN_DETECTOR_URL
        fromService:
          type: web
          name: pattern-detector-api
          envVarKey: RENDER_EXTERNAL_URL
      - key: PYTHON_NEWS_AGENT_URL
        fromService:
          type: web
          name: news-agent-api
          envVarKey: RENDER_EXTERNAL_URL
      - key: PYTHON_BACKTEST_ENGINE_URL
        fromService:
          type: web
          name: backtest-engine-api
          envVarKey: RENDER_EXTERNAL_URL
    autoDeploy: true

  # ========================================
  # PATTERN DETECTOR SERVICE
  # ========================================
  - type: web
    name: pattern-detector-api
    env: docker
    dockerfilePath: ./python-services/pattern-detector/Dockerfile
    dockerContext: ./python-services/pattern-detector
    branch: master
    plan: starter
    healthCheckPath: /health
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: PORT
        value: 8001
      - key: DATABASE_URL
        sync: false  # Must be set manually in Render dashboard
    autoDeploy: true

  # ========================================
  # NEWS AGENT SERVICE
  # ========================================
  - type: web
    name: news-agent-api
    env: docker
    dockerfilePath: ./python-services/news-agent/Dockerfile
    dockerContext: ./python-services/news-agent
    branch: master
    plan: starter
    healthCheckPath: /health
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: PORT
        value: 8002
      - key: NEWS_API_KEY
        sync: false  # User must set this manually
      - key: HUGGINGFACE_API_KEY
        sync: false  # Optional, user can set manually
      - key: ANTHROPIC_API_KEY
        sync: false  # Optional - for Claude AI
      - key: OPENAI_API_KEY
        sync: false  # Optional - for OpenAI
      - key: GOOGLE_API_KEY
        sync: false  # Optional - for Gemini AI
    autoDeploy: true

  # ========================================
  # BACKTEST ENGINE SERVICE
  # ========================================
  - type: web
    name: backtest-engine-api
    env: docker
    dockerfilePath: ./python-services/Dockerfile
    dockerContext: ./python-services
    branch: master
    plan: starter
    healthCheckPath: /health
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: PORT
        value: 8003
      - key: DATABASE_URL
        sync: false  # Must be set manually in Render dashboard
    autoDeploy: true
